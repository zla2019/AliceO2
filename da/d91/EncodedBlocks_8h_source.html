<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/travis/build/AliceO2Group/AliceO2/DataFormats/Detectors/Common/include/DetectorsCommonDataFormats/EncodedBlocks.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/d91/EncodedBlocks_8h_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">EncodedBlocks.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d91/EncodedBlocks_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright CERN and copyright holders of ALICE O2. This software is</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// distributed under the terms of the GNU General Public License v3 (GPL</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// See http://alice-o2.web.cern.ch/license for full licensing information.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// or submit itself to any jurisdiction.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifndef ALICEO2_ENCODED_BLOCKS_H</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define ALICEO2_ENCODED_BLOCKS_H</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;type_traits&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;Rtypes.h&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/de7/rans_8h.html">rANS/rans.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;TTree.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d8f/StringUtils_8h.html">CommonUtils/StringUtils.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/da4/Logger_8h.html">Framework/Logger.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span>ctf</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d5/d86/namespaceo2_1_1rans.html">o2::rans</a>;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#aa160104733244d7309adca999ace2e7a">   31</a></span>&#160;constexpr <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa160104733244d7309adca999ace2e7a">Alignment</a> = 16;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#aa1c9dd9453617d8d847092824ee7a4c1">   33</a></span>&#160;constexpr <span class="keywordtype">int</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa1c9dd9453617d8d847092824ee7a4c1">WrappersSplitLevel</a> = 99;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#a47c34e2a9290f7a6251f3a4e0021d1e2">   34</a></span>&#160;constexpr <span class="keywordtype">int</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#a47c34e2a9290f7a6251f3a4e0021d1e2">WrappersCompressionLevel</a> = 1;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#a4b638fccf2b5ccc5ad3f578fd624241b">   37</a></span>&#160;<span class="keyword">using</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#a4b638fccf2b5ccc5ad3f578fd624241b">BufferType</a> = uint8_t; <span class="comment">// to avoid every detector using different types, we better define it here</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">   40</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keywordtype">size_t</span> sizeBytes)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keyword">auto</span> res = sizeBytes % <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa160104733244d7309adca999ace2e7a">Alignment</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">return</span> res ? sizeBytes + (Alignment - res) : sizeBytes;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="../../d5/d05/namespaceo2_1_1ctf.html#ac0e06b95c4b1602bbe81ed6cdbeef868">   48</a></span>&#160;<span class="keyword">inline</span> T* <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#ac0e06b95c4b1602bbe81ed6cdbeef868">relocatePointer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* oldBase, <span class="keywordtype">char</span>* newBase, <span class="keyword">const</span> T* ptr)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">return</span> (ptr != <span class="keyword">nullptr</span>) ? <span class="keyword">reinterpret_cast&lt;</span>T*<span class="keyword">&gt;</span>(newBase + (<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(ptr) - oldBase)) : <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">   55</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a> {</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#abaf306f6a83070c115b0c5a335a3e0f7">   56</a></span>&#160;  uint8_t <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#abaf306f6a83070c115b0c5a335a3e0f7">majorVersion</a>;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#ae00e41a2ff0bab7de041248506bb8fd1">   57</a></span>&#160;  uint8_t <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#ae00e41a2ff0bab7de041248506bb8fd1">minorVersion</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#a5b9ca95c0746a7c645e9a3c72617410f">   59</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#a5b9ca95c0746a7c645e9a3c72617410f">clear</a>() { majorVersion = minorVersion = 0; }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  ClassDefNV(<a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a>, 1);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;};</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">   63</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a> {</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">   64</a></span>&#160;  <span class="keyword">enum class</span> <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">OptStore</a> : uint8_t { <span class="comment">// describe how the store the data described by this metadata</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    EENCODE,                      <span class="comment">// entropy encoding applied</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    ROOTCompression,              <span class="comment">// original data repacked to array with slot-size = streamSize and saved with root compression</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="../../db/dc1/namespaceo2_1_1emcal.html#a6c868ddf88a9b19f60067aebad08b9d4a2f9917fd4cd650c84d0599f223287dbc">NONE</a>,                         <span class="comment">// original data repacked to array with slot-size = streamSize and saved w/o compression</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    NODATA                        <span class="comment">// no data was provided</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  };</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#a88bcc4eeffeb097d55b377cb49ac16da">   70</a></span>&#160;  <span class="keywordtype">size_t</span> messageLength = 0;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#af35e28f6769cdfdfc4b59d994d054444">   71</a></span>&#160;  uint8_t coderType = 0;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#acafa842295707ff047d7283bb4dad3f2">   72</a></span>&#160;  uint8_t streamSize = 0;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#aa5cf648dc6da755844d927a79b8954b2">   73</a></span>&#160;  uint8_t probabilityBits = 0;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ab4544a2dc7e448bc1707c6544ee66d38">   74</a></span>&#160;  <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">OptStore</a> opt = OptStore::EENCODE;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#acf8a4680716afcd50260079085e23b4b">   75</a></span>&#160;  int32_t <a class="code" href="../../d2/d0e/test__Algorithm_8cxx.html#af7be6f6143db3904668b719460e15009">min</a> = 0;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#a6f736eeb65f90ec8b44982cb1c46dc28">   76</a></span>&#160;  int32_t <a class="code" href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">max</a> = 0;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ad1c877702887a0b2d94b234f86a2b4da">   77</a></span>&#160;  <span class="keywordtype">int</span> nDictWords = 0;</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae51440b0d425c2952de2b28426659c57">   78</a></span>&#160;  <span class="keywordtype">int</span> nDataWords = 0;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#a3d1fe656972103c748084405eb451166">   80</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#a3d1fe656972103c748084405eb451166">clear</a>()</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    min = max = 0;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    messageLength = 0;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    coderType = 0;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    streamSize = 0;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    probabilityBits = 0;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    nDataWords = nDictWords = 0;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  ClassDefNV(<a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a>, 1);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;};</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">   93</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">Registry</a> {</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a4d2419e2901128f30dd20ffc2af1a205">   94</a></span>&#160;  <span class="keywordtype">char</span>* head = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a022a911fc4155b45c5473764cba00fb2">   95</a></span>&#160;  <span class="keywordtype">int</span> nFilledBlocks = 0;    <span class="comment">// number of filled blocks = next block to fill (must be strictly consecutive)</span></div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a4563cf16f0e2ebed0da3b5a533bea043">   96</a></span>&#160;  <span class="keywordtype">size_t</span> offsFreeStart = 0; <span class="comment">// offset of the start of the writable space (wrt head), in bytes!!!</span></div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a3898f9d76c6b8d82db1be0b8780f41aa">   97</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a> = 0;          <span class="comment">// full size in bytes!!!</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">  100</a></span>&#160;  <span class="keywordtype">char</span>* <a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">getFreeBlockStart</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(offsFreeStart &lt;= size);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> head + offsFreeStart;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a9d78d817489bcdee225107478aac6021">  107</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a9d78d817489bcdee225107478aac6021">shrinkFreeBlock</a>(<span class="keywordtype">size_t</span> sz)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    offsFreeStart = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(offsFreeStart + sz);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(offsFreeStart &lt;= size);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a35eb073a9d1ae2c7d645e3142983ab18">  114</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a35eb073a9d1ae2c7d645e3142983ab18">getFreeSize</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">  </span>{</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> size - offsFreeStart;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  ClassDefNV(<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">Registry</a>, 1);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;};</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> W = u<span class="keywordtype">int</span>32_t&gt;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html">  124</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html">Block</a> {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a17ba81b652751e4695646e8f73c919c8">  126</a></span>&#160;  <a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">Registry</a>* registry = <span class="keyword">nullptr</span>; </div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a7296ef590c9d41517771e9477ca4d7d0">  127</a></span>&#160;  <span class="keywordtype">int</span> nDict = 0;                <span class="comment">// dictionary length (if any)</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ab65d168fed9da210d33f04fc5f8e7232">  128</a></span>&#160;  <span class="keywordtype">int</span> nStored = 0;              <span class="comment">// total payload: data + dictionary length</span></div><div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#afc9e139351246a171c7f68625bde00b7">  129</a></span>&#160;  W* payload = <span class="keyword">nullptr</span>;         <span class="comment">//[nStored];</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ae96653babe0614d00002125d71336f08">  131</a></span>&#160;  W* <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ae96653babe0614d00002125d71336f08">getData</a>() { <span class="keywordflow">return</span> payload + nDict; }</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a86c97211ed5538faf9876fde304c870d">  132</a></span>&#160;  W* <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a86c97211ed5538faf9876fde304c870d">getDict</a>() { <span class="keywordflow">return</span> nDict ? payload : <span class="keyword">nullptr</span>; }</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a2d430bc0f51e55a6cddc4ca49026e7af">  133</a></span>&#160;  <span class="keyword">const</span> W* <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a2d430bc0f51e55a6cddc4ca49026e7af">getData</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> payload + nDict; }</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a89a86a7af8f9751ed26d73d62b1c821e">  134</a></span>&#160;  <span class="keyword">const</span> W* <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a89a86a7af8f9751ed26d73d62b1c821e">getDict</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nDict ? payload : <span class="keyword">nullptr</span>; }</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ac4f81e21c9916c0ef309fe8f9b4a8189">  135</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ac4f81e21c9916c0ef309fe8f9b4a8189">getNData</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nStored - nDict; }</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8ad949649e1e599f76c8ab3814aae219">  136</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8ad949649e1e599f76c8ab3814aae219">getNDict</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> nDict; }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a5436cc865355f1b777b4c24395ffd397">  138</a></span>&#160;  <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a5436cc865355f1b777b4c24395ffd397">~Block</a>()</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (!registry) { <span class="comment">// this is a standalone block owning its data</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keyword">delete</span>[] payload;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#acf9ae78e9ec49ffcd1c29fc7410d1c48">  146</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#acf9ae78e9ec49ffcd1c29fc7410d1c48">clear</a>()</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    nDict = nStored = 0;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    payload = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a90ac68a9e2a0cd23862c2ed1d0fb3afd">  153</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a90ac68a9e2a0cd23862c2ed1d0fb3afd">estimateSize</a>(<span class="keywordtype">int</span> _ndict, <span class="keywordtype">int</span> _ndata)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>((_ndict + _ndata) * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// store a dictionary in an empty block</span></div><div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a55c17f669f5a8964c48353ed196467b6">  159</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a55c17f669f5a8964c48353ed196467b6">storeDict</a>(<span class="keywordtype">int</span> _ndict, <span class="keyword">const</span> W* _dict)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span> (nDict || nStored) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;trying to write in occupied block&quot;</span>);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>(_ndict, 0);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(registry); <span class="comment">// this method is valid only for flat version, which has a registry</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(sz &lt;= registry-&gt;getFreeSize());</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>((_ndict &gt; 0) == (_dict != <span class="keyword">nullptr</span>));</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    nDict = nStored = _ndict;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (nDict) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="keyword">auto</span> ptr = payload = <span class="keyword">reinterpret_cast&lt;</span>W*<span class="keyword">&gt;</span>(registry-&gt;<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">getFreeBlockStart</a>());</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      memcpy(ptr, _dict, _ndict * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      ptr += _ndict;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  };</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// store a dictionary to a block which can either be empty or contain a dict.</span></div><div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8c60995bd0c2c8c06be04f790624b2e5">  177</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8c60995bd0c2c8c06be04f790624b2e5">storeData</a>(<span class="keywordtype">int</span> _ndata, <span class="keyword">const</span> W* _data)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (nStored &gt; nDict) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;trying to write in occupied block&quot;</span>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>(0, _ndata);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(registry); <span class="comment">// this method is valid only for flat version, which has a registry</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(sz &lt;= registry-&gt;getFreeSize());</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>((_ndata &gt; 0) == (_data != <span class="keyword">nullptr</span>));</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    nStored = nDict + _ndata;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (_ndata) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">auto</span> ptr = payload = <span class="keyword">reinterpret_cast&lt;</span>W*<span class="keyword">&gt;</span>(registry-&gt;<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">getFreeBlockStart</a>());</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      ptr += nDict;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      memcpy(ptr, _data, _ndata * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// resize block and free up unused buffer space.</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a536199d8f0723028e5b7c7b337586dbe">  196</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a536199d8f0723028e5b7c7b337586dbe">endBlock</a>()</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>(nStored, 0);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    registry-&gt;<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a9d78d817489bcdee225107478aac6021">shrinkFreeBlock</a>(sz);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a3f875b5e24a47499a3583a86508b1418">  203</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a3f875b5e24a47499a3583a86508b1418">store</a>(<span class="keywordtype">int</span> _ndict, <span class="keywordtype">int</span> _ndata, <span class="keyword">const</span> W* _dict, <span class="keyword">const</span> W* _data)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>(_ndict, _ndata);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(registry); <span class="comment">// this method is valid only for flat version, which has a registry</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(sz &lt;= registry-&gt;getFreeSize());</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>((_ndict &gt; 0) == (_dict != <span class="keyword">nullptr</span>));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>((_ndata &gt; 0) == (_data != <span class="keyword">nullptr</span>));</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    nStored = _ndict + _ndata;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    nDict = _ndict;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (nStored) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keyword">auto</span> ptr = payload = <span class="keyword">reinterpret_cast&lt;</span>W*<span class="keyword">&gt;</span>(registry-&gt;<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">getFreeBlockStart</a>());</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">if</span> (_dict) {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        memcpy(ptr, _dict, _ndict * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        ptr += _ndict;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="keywordflow">if</span> (_data) {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        memcpy(ptr, _data, _ndata * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    registry-&gt;<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a9d78d817489bcdee225107478aac6021">shrinkFreeBlock</a>(sz);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#aff774113b4668a8c33d20c113733dc95">  226</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#aff774113b4668a8c33d20c113733dc95">relocate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* oldHead, <span class="keywordtype">char</span>* newHeadData, <span class="keywordtype">char</span>* newHeadRegistry)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    payload = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#ac0e06b95c4b1602bbe81ed6cdbeef868">relocatePointer</a>(oldHead, newHeadData, payload);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    registry = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#ac0e06b95c4b1602bbe81ed6cdbeef868">relocatePointer</a>(oldHead, newHeadRegistry, registry);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  ClassDefNV(<a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html">Block</a>, 1);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}; <span class="comment">// namespace ctf</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W = u<span class="keywordtype">int</span>32_t&gt;</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">  238</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abed9840c0447cc39c2d4b018b031a230">  241</a></span>&#160;  <span class="keyword">typedef</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks&lt;H, N, W&gt;</a> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abed9840c0447cc39c2d4b018b031a230">base</a>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a347345f71646cd95c2a7459bbf4c9842">  243</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a347345f71646cd95c2a7459bbf4c9842">setHeader</a>(<span class="keyword">const</span> H&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a>) { mHeader = <a class="code" href="../../dc/da3/glcorearb_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a>; }</div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad856da2afe92c5d1a228e21221c1602b">  244</a></span>&#160;  <span class="keyword">const</span> H&amp; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad856da2afe92c5d1a228e21221c1602b">getHeader</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mHeader; }</div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae54384c11e9cff5e296476d9f33ae4d1">  245</a></span>&#160;  H&amp; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae54384c11e9cff5e296476d9f33ae4d1">getHeader</a>() { <span class="keywordflow">return</span> mHeader; }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3aaff1e64e6278b7f9075eeab44d1bc6">  247</a></span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3aaff1e64e6278b7f9075eeab44d1bc6">getMetadata</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mMetadata; }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac8f9f9ff9048ed510535b9343c8a19af">  249</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac8f9f9ff9048ed510535b9343c8a19af">setANSHeader</a>(<span class="keyword">const</span> <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a>&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a>) { mANSHeader = <a class="code" href="../../dc/da3/glcorearb_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a>; }</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61fd53321d30d2fd70d35b60fbe5090a">  250</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a>&amp; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61fd53321d30d2fd70d35b60fbe5090a">getANSHeader</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mANSHeader; }</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a69556a5d7d83658a093e1d2ad2445b08">  251</a></span>&#160;  <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a>&amp; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a69556a5d7d83658a093e1d2ad2445b08">getANSHeader</a>() { <span class="keywordflow">return</span> mANSHeader; }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9f5c32c4ccb8a00a51d1fcb0f2006f01">  253</a></span>&#160;  <span class="keyword">static</span> constexpr <span class="keywordtype">int</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9f5c32c4ccb8a00a51d1fcb0f2006f01">getNBlocks</a>() { <span class="keywordflow">return</span> N; }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a85e9b5bc7aa7dd65bcca25df8f748895">  255</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a85e9b5bc7aa7dd65bcca25df8f748895">getMinAlignedSize</a>() { <span class="keywordflow">return</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(base)); }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a1e28fb516c55cc8e4112b9e536dc7cb1">  258</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">auto</span> <span class="keyword">get</span>(<span class="keywordtype">void</span>* head) { <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a>*<span class="keyword">&gt;</span>(head); }</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a89d24c3400fb3515222094ef7850926c">  259</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> <span class="keyword">get</span>(<span class="keyword">const</span> <span class="keywordtype">void</span>* head) { <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a>*<span class="keyword">&gt;</span>(head); }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> getImage(<span class="keyword">const</span> <span class="keywordtype">void</span>* newHead);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">create</a>(<span class="keywordtype">void</span>* head, <span class="keywordtype">size_t</span> sz);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code" href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">create</a>(VD&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac1922a4178604c0a73bde4b200ed9ee6">  272</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac1922a4178604c0a73bde4b200ed9ee6">estimateBlockSize</a>(<span class="keywordtype">int</span> _ndict, <span class="keywordtype">int</span> _ndata) { <span class="keywordflow">return</span> <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a90ac68a9e2a0cd23862c2ed1d0fb3afd">Block&lt;W&gt;::estimateSize</a>(_ndict, _ndata); }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aa6c6e7651749d02ac2ec47f432e7fbf1">  275</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aa6c6e7651749d02ac2ec47f432e7fbf1">empty</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (mRegistry.offsFreeStart == <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(*<span class="keyword">this</span>))) &amp;&amp; (mRegistry.size &gt;= mRegistry.offsFreeStart); }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9690d6865fb7515b20a6849aa77f0a10">  278</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9690d6865fb7515b20a6849aa77f0a10">flat</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mRegistry.size &gt; 0 &amp;&amp; (mRegistry.size &gt;= mRegistry.offsFreeStart) &amp;&amp; (mBlocks[0].registry == &amp;mRegistry) &amp;&amp; (mBlocks[N - 1].registry == &amp;mRegistry); }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../df/d18/namespaceo2_1_1mid.html#aca82e9e929edf59c003b2a1b07a3ec69">clear</a>();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab443ecb6cb5d9775a65f445f855dd068">  284</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab443ecb6cb5d9775a65f445f855dd068">compactify</a>() { <span class="keywordflow">return</span> (mRegistry.size = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>()); }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abc51b0c0a175495bad9ba3b5f02d4e93">  287</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abc51b0c0a175495bad9ba3b5f02d4e93">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mRegistry.size; }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad1d812ed0ac3b35139656fe9e070f35e">  290</a></span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad1d812ed0ac3b35139656fe9e070f35e">getFreeSize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mRegistry.getFreeSize(); }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VB&gt;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">static</span> <span class="keyword">auto</span> expand(VB&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>, <span class="keywordtype">size_t</span> newsizeBytes);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">void</span> copyToFlat(V&amp; vec);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6406121e1440325e1fc4b0e3f1506ce4">  301</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6406121e1440325e1fc4b0e3f1506ce4">copyToFlat</a>(<span class="keywordtype">void</span>* base) { fillFlatCopy(<a class="code" href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">create</a>(base, <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>())); }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#a0796d4945640fb8e3a9d4972b4e585d9">appendToTree</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>) <span class="keyword">const</span>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#a2c7c357a9e7b41805002daf1fd9d79d8">readFromTree</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">int</span> ev = 0);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#a2c7c357a9e7b41805002daf1fd9d79d8">readFromTree</a>(VD&amp; vec, TTree&amp; tree, <span class="keyword">const</span> std::string&amp; name, <span class="keywordtype">int</span> ev = 0);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VE, <span class="keyword">typename</span> VB&gt;</div><div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad6964e2f1336bd82e4506752d7308cff">  315</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad6964e2f1336bd82e4506752d7308cff">encode</a>(<span class="keyword">const</span> VE&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a2a98ddb6f79ec1048ff9e15cdd2422ba">src</a>, <span class="keywordtype">int</span> slot, uint8_t probabilityBits, <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">Metadata::OptStore</a> opt, VB* buffer = <span class="keyword">nullptr</span>)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="../../d2/d26/namespaceo2_1_1mch_1_1raw.html#aeec8f9de7175e5ccef417cd8968d1ac7">encode</a>(&amp;(*src.begin()), &amp;(*src.end()), slot, probabilityBits, opt, buffer);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> S, <span class="keyword">typename</span> VB&gt;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d2/d26/namespaceo2_1_1mch_1_1raw.html#aeec8f9de7175e5ccef417cd8968d1ac7">encode</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d6a/structS.html">S</a>* <span class="keyword">const</span> srcBegin, <span class="keyword">const</span> <a class="code" href="../../d1/d6a/structS.html">S</a>* <span class="keyword">const</span> srcEnd, <span class="keywordtype">int</span> slot, uint8_t probabilityBits, <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">Metadata::OptStore</a> opt, VB* buffer = <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordtype">void</span> decode(VD&amp; dest, <span class="keywordtype">int</span> slot) <span class="keyword">const</span>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">void</span> decode(D* dest, <span class="keywordtype">int</span> slot) <span class="keyword">const</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="../../d7/d33/testBareElinkEncoder_8cxx.html#a61d454dcf3f57efb6c741c369b92cbf8">print</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; <span class="keyword">protected</span>:</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9974673b455dd802a139bfa1b5c39413">  336</a></span>&#160;  static_assert(N &gt; 0, <span class="stringliteral">&quot;number of encoded blocks &lt; 1&quot;</span>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">Registry</a> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9974673b455dd802a139bfa1b5c39413">mRegistry</a>;                </div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6eac3a6976e46e605ab878679a99cd68">  339</a></span>&#160;  <a class="code" href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">ANSHeader</a> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6eac3a6976e46e605ab878679a99cd68">mANSHeader</a>;              <span class="comment">//  ANS header</span></div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#af28de74fa2a5626839d8975a66caeacb">  340</a></span>&#160;  H <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#af28de74fa2a5626839d8975a66caeacb">mHeader</a>;                         <span class="comment">//  detector specific header</span></div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#afb54a7f40abc09c5f84340c7636788d1">  341</a></span>&#160;  std::array&lt;Metadata, N&gt; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#afb54a7f40abc09c5f84340c7636788d1">mMetadata</a>; <span class="comment">//  compressed block&#39;s details</span></div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6bf756e6e1c4bc2a8a5e4caa5e0ff8f4">  342</a></span>&#160;  std::array&lt;Block&lt;W&gt;, N&gt; <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6bf756e6e1c4bc2a8a5e4caa5e0ff8f4">mBlocks</a>;   </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordtype">void</span> init(<span class="keywordtype">size_t</span> sz);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> relocate(<span class="keyword">const</span> <span class="keywordtype">char</span>* oldHead, <span class="keywordtype">char</span>* newHead, <span class="keywordtype">char</span>* wrapper, <span class="keywordtype">size_t</span> newsize = 0);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>() <span class="keyword">const</span>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">size_t</span> estimateSizeFromMetadata() <span class="keyword">const</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">void</span> fillFlatCopy(<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a>&amp; dest) <span class="keyword">const</span>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> fillTreeBranch(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; brname, D&amp; dt, <span class="keywordtype">int</span> compLevel, <span class="keywordtype">int</span> splitLevel = 99);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> readTreeBranch(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; brname, D&amp; dt, <span class="keywordtype">int</span> ev = 0);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  ClassDefNV(<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a>, 1);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;};</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a13784e3c1672987dc92d6e8fb1bd89a2">  377</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a13784e3c1672987dc92d6e8fb1bd89a2">EncodedBlocks&lt;H, N, W&gt;::readFromTree</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>, <span class="keywordtype">int</span> ev)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  readTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_wrapper.&quot;</span>), *<span class="keyword">this</span>, ev);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    readTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_block.&quot;</span>, std::to_string(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), <span class="stringliteral">&quot;.&quot;</span>), mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a403477fec1c7bb1323475423099ba37b">  389</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a13784e3c1672987dc92d6e8fb1bd89a2">EncodedBlocks&lt;H, N, W&gt;::readFromTree</a>(VD&amp; vec, TTree&amp; tree, <span class="keyword">const</span> std::string&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>, <span class="keywordtype">int</span> ev)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">auto</span> tmp = <a class="code" href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">create</a>(vec);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  readTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_wrapper.&quot;</span>), *tmp, ev);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  tmp = tmp-&gt;expand(vec, tmp-&gt;estimateSizeFromMetadata());</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html">Block&lt;W&gt;</a> bl;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    readTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_block.&quot;</span>, std::to_string(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), <span class="stringliteral">&quot;.&quot;</span>), bl);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    tmp-&gt;mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].store(bl.<a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8ad949649e1e599f76c8ab3814aae219">getNDict</a>(), bl.<a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ac4f81e21c9916c0ef309fe8f9b4a8189">getNData</a>(), bl.<a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a86c97211ed5538faf9876fde304c870d">getDict</a>(), bl.<a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ae96653babe0614d00002125d71336f08">getData</a>());</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a39d60c21a76ab4c89cd21c16f0ab964d">  404</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a39d60c21a76ab4c89cd21c16f0ab964d">EncodedBlocks&lt;H, N, W&gt;::appendToTree</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a>)<span class="keyword"> const</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  fillTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_wrapper.&quot;</span>), const_cast&lt;base&amp;&gt;(*<span class="keyword">this</span>), WrappersCompressionLevel, WrappersSplitLevel);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d8/de9/qconfigoptions_8h.html#ad6a3458d4354900cec9f1644c84948d1">compression</a> = mMetadata[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].opt == <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782a96fd97346a337137c5796ebf7bfcca8a">Metadata::OptStore::ROOTCompression</a> ? 1 : 0;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    fillTreeBranch(tree, <a class="code" href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a>(name, <span class="stringliteral">&quot;_block.&quot;</span>, std::to_string(<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>), <span class="stringliteral">&quot;.&quot;</span>), <span class="keyword">const_cast&lt;</span><a class="code" href="../../d5/db7/structo2_1_1ctf_1_1Block.html">Block&lt;W&gt;</a>&amp;<span class="keyword">&gt;</span>(mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>]), compression);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a323e891e294642746723d9981402ed60">  417</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a323e891e294642746723d9981402ed60">EncodedBlocks&lt;H, N, W&gt;::readTreeBranch</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; brname, D&amp; dt, <span class="keywordtype">int</span> ev)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">auto</span>* br = tree.GetBranch(brname.c_str());</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(br);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">auto</span>* ptr = &amp;dt;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  br-&gt;SetAddress(&amp;ptr);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  br-&gt;GetEntry(ev);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  br-&gt;ResetAddress();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a35637d4923ea13a25ec5390d1c291813">  431</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a35637d4923ea13a25ec5390d1c291813">EncodedBlocks&lt;H, N, W&gt;::fillTreeBranch</a>(TTree&amp; tree, <span class="keyword">const</span> std::string&amp; brname, D&amp; dt, <span class="keywordtype">int</span> compLevel, <span class="keywordtype">int</span> splitLevel)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keyword">auto</span>* br = tree.Branch(brname.c_str(), &amp;dt, 512, splitLevel);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  br-&gt;SetCompressionLevel(compLevel);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  br-&gt;Fill();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61ce778e88ae55800d49d9b46260cbac">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61ce778e88ae55800d49d9b46260cbac">EncodedBlocks&lt;H, N, W&gt;::fillFlatCopy</a>(<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">EncodedBlocks</a>&amp; dest)<span class="keyword"> const</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aa6c6e7651749d02ac2ec47f432e7fbf1">empty</a>() &amp;&amp; dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9974673b455dd802a139bfa1b5c39413">mRegistry</a>.<a class="code" href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a35eb073a9d1ae2c7d645e3142983ab18">getFreeSize</a>() &lt; <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>());</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6eac3a6976e46e605ab878679a99cd68">mANSHeader</a> = mANSHeader;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#af28de74fa2a5626839d8975a66caeacb">mHeader</a> = mHeader;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#afb54a7f40abc09c5f84340c7636788d1">mMetadata</a> = mMetadata;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    dest.<a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6bf756e6e1c4bc2a8a5e4caa5e0ff8f4">mBlocks</a>[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].store(mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNDict(), mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNData(), mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getDict(), mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getData());</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> V&gt;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aefd9063250065412dc2c6eb723715afe">  456</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aefd9063250065412dc2c6eb723715afe">EncodedBlocks&lt;H, N, W&gt;::copyToFlat</a>(V&amp; vec)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keyword">auto</span> vtsz = <span class="keyword">sizeof</span>(<span class="keyword">typename</span> std::remove_reference&lt;decltype(vec)&gt;::type::value_type), sz = <a class="code" href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a>();</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  vec.resize(sz / vtsz);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  copyToFlat(vec.data());</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30672fcec0a70a571ecb9c836752abe7">  467</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30672fcec0a70a571ecb9c836752abe7">EncodedBlocks&lt;H, N, W&gt;::estimateSize</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="keywordtype">size_t</span> sz = 0;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  sz += <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(*<span class="keyword">this</span>));</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    sz += <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].nStored * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">return</span> sz;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30e823ac8c858ec9122baf5c327e02eb">  481</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30e823ac8c858ec9122baf5c327e02eb">EncodedBlocks&lt;H, N, W&gt;::estimateSizeFromMetadata</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordtype">size_t</span> sz = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(*<span class="keyword">this</span>));</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    sz += <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>((mMetadata[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].nDictWords + mMetadata[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].nDataWords) * <span class="keyword">sizeof</span>(W));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">return</span> sz;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VB&gt;</div><div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ade44fd63c8b3b0bce7875a5d45b6c102">  494</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ade44fd63c8b3b0bce7875a5d45b6c102">EncodedBlocks&lt;H, N, W&gt;::expand</a>(VB&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>, <span class="keywordtype">size_t</span> newsizeBytes)</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;{</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keyword">auto</span> buftypesize = <span class="keyword">sizeof</span>(<span class="keyword">typename</span> std::remove_reference&lt;decltype(buffer)&gt;::type::value_type);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="keyword">auto</span>* oldHead = <span class="keyword">get</span>(buffer.data())-&gt;mRegistry.head;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  buffer.resize(<a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(newsizeBytes) / buftypesize);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  relocate(oldHead, reinterpret_cast&lt;char*&gt;(buffer.data()), reinterpret_cast&lt;char*&gt;(buffer.data()), newsizeBytes);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">get</span>(buffer.data());</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3275ee8121097f6edd1699258dd424c7">  510</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3275ee8121097f6edd1699258dd424c7">EncodedBlocks&lt;H, N, W&gt;::relocate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* oldHead, <span class="keywordtype">char</span>* newHead, <span class="keywordtype">char</span>* wrapper, <span class="keywordtype">size_t</span> newsize)</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keyword">auto</span> newStr = <span class="keyword">get</span>(wrapper);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    newStr-&gt;mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].relocate(oldHead, newHead, wrapper);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  newStr-&gt;mRegistry.head = newHead; <span class="comment">// newHead points on the real data</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// if asked, update the size</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">if</span> (newsize) { <span class="comment">// in bytes!!!</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(newStr-&gt;estimateSize() &lt;= newsize);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    newStr-&gt;mRegistry.size = newsize;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae9bb90cc3237ae8f3755a54c42d9c6d2">  527</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae9bb90cc3237ae8f3755a54c42d9c6d2">EncodedBlocks&lt;H, N, W&gt;::init</a>(<span class="keywordtype">size_t</span> sz)</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  mRegistry.head = <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  mRegistry.size = sz;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  mRegistry.offsFreeStart = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(*<span class="keyword">this</span>));</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    mMetadata[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].registry = &amp;mRegistry;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a24e423762e06e2bc78076d96ce5417a2">  542</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a24e423762e06e2bc78076d96ce5417a2">EncodedBlocks&lt;H, N, W&gt;::clear</a>()</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    mMetadata[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  mRegistry.offsFreeStart = <a class="code" href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">alignSize</a>(<span class="keyword">sizeof</span>(*<span class="keyword">this</span>));</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab1c2e567ff37876e0897b911a57a7b1d">  554</a></span>&#160;<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab1c2e567ff37876e0897b911a57a7b1d">EncodedBlocks&lt;H, N, W&gt;::getImage</a>(<span class="keyword">const</span> <span class="keywordtype">void</span>* newHead)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a>(*<span class="keyword">get</span>(newHead)); <span class="comment">// 1st make a shalow copy</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// now fix its pointers</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// we don&#39;t modify newHead, but still need to remove constness for relocation interface</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  relocate(<a class="code" href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a>.mRegistry.head, const_cast&lt;char*&gt;(reinterpret_cast&lt;const char*&gt;(newHead)), reinterpret_cast&lt;char*&gt;(&amp;<a class="code" href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a>));</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <a class="code" href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a>.print();</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">return</span> std::move(<a class="code" href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#adf063580118adfecfb984b0ad901bb83">  568</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#adf063580118adfecfb984b0ad901bb83">EncodedBlocks&lt;H, N, W&gt;::create</a>(<span class="keywordtype">void</span>* head, <span class="keywordtype">size_t</span> sz)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keyword">auto</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a> = <span class="keyword">get</span>(head);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>-&gt;init(sz);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac05f11927d5f8de278625c3bb0752880">  579</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#adf063580118adfecfb984b0ad901bb83">EncodedBlocks&lt;H, N, W&gt;::create</a>(VD&amp; <a class="code" href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a>)</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;{</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <span class="keywordtype">size_t</span> vsz = <span class="keyword">sizeof</span>(<span class="keyword">typename</span> std::remove_reference&lt;decltype(v)&gt;::type::value_type); <span class="comment">// size of the element of the buffer</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keyword">auto</span> baseSize = getMinAlignedSize() / vsz;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (v.size() &lt; baseSize) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    v.resize(baseSize);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">create</a>(v.data(), v.size() * vsz);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;}</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae8d78563f06dfeb49a3590c0dc8ed7f9">  592</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae8d78563f06dfeb49a3590c0dc8ed7f9">EncodedBlocks&lt;H, N, W&gt;::print</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Container &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot; blocks, size: &quot;</span> &lt;&lt; <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a>() &lt;&lt; <span class="stringliteral">&quot; bytes, unused: &quot;</span> &lt;&lt; getFreeSize();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; N; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Block &quot;</span> &lt;&lt; <a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; NDictWords: &quot;</span> &lt;&lt; mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNDict() &lt;&lt; <span class="stringliteral">&quot; NDataWords: &quot;</span> &lt;&lt; mBlocks[<a class="code" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a>].getNData();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> VD&gt;</div><div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9e8a6a8e8f330d975f5e151d92f665f3">  603</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9e8a6a8e8f330d975f5e151d92f665f3">EncodedBlocks&lt;H, N, W&gt;::decode</a>(VD&amp; dest,       <span class="comment">// destination container</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                           <span class="keywordtype">int</span> slot) <span class="keyword">const</span> <span class="comment">// slot of the block to decode</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  dest.resize(mMetadata[slot].messageLength); <span class="comment">// allocate output buffer</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  decode(dest.data(), slot);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> D&gt;</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a67f272cffc4747a264f8e07be10ef071">  613</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9e8a6a8e8f330d975f5e151d92f665f3">EncodedBlocks&lt;H, N, W&gt;::decode</a>(D* dest,        <span class="comment">// destination pointer</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                    <span class="keywordtype">int</span> slot) <span class="keyword">const</span> <span class="comment">// slot of the block to decode</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="comment">// get references to the right data</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; block = mBlocks[slot];</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; md = mMetadata[slot];</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="comment">// decode</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">if</span> (block.getNData()) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (md.opt == <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782a1d44bfe69b33f3ab9efcfbb651a80f9d">Metadata::OptStore::EENCODE</a>) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(block.getNDict()); <span class="comment">// at the moment we expect to have dictionary</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <a class="code" href="../../d2/d85/classo2_1_1rans_1_1SymbolStatistics.html">o2::rans::SymbolStatistics</a> stats(block.getDict(), block.getDict() + block.getNDict(), md.min, md.max, md.messageLength);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="../../d0/d91/classo2_1_1rans_1_1Decoder.html">o2::rans::Decoder64&lt;D&gt;</a> decoder(stats, md.probabilityBits);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      decoder.process(dest, block.getData() + block.getNData(), md.messageLength);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// data was stored as is</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      std::memcpy(dest, block.payload, md.messageLength * <span class="keyword">sizeof</span>(D));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;}</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> H, <span class="keywordtype">int</span> N, <span class="keyword">typename</span> W&gt;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> S, <span class="keyword">typename</span> VB&gt;</div><div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a2637244b1904861f4c1cc9ec9fafc122">  636</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad6964e2f1336bd82e4506752d7308cff">EncodedBlocks&lt;H, N, W&gt;::encode</a>(<span class="keyword">const</span> <a class="code" href="../../d1/d6a/structS.html">S</a>* <span class="keyword">const</span> srcBegin, <span class="comment">// begin of source message</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="../../d1/d6a/structS.html">S</a>* <span class="keyword">const</span> srcEnd,   <span class="comment">// end of source message</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                    <span class="keywordtype">int</span> slot,                <span class="comment">// slot in encoded data to fill</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                    uint8_t probabilityBits, <span class="comment">// encoding into</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                    <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">Metadata::OptStore</a> opt,  <span class="comment">// option for data compression</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                    VB* <a class="code" href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>)              <span class="comment">// optional buffer (vector) providing memory for encoded blocks</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;{</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// fill a new block</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <a class="code" href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a>(slot == mRegistry.nFilledBlocks);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  mRegistry.nFilledBlocks++;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="keyword">using</span> stream_t = <span class="keyword">typename</span> <a class="code" href="../../dd/d50/classo2_1_1rans_1_1Encoder.html#a8b1c72037483eca59fb7c9d34934a1cf">o2::rans::Encoder64&lt;S&gt;::stream_t</a>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">// cover three cases:</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// * empty source message: no entropy coding</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="comment">// * source message to pass through without any entropy coding</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="comment">// * source message where entropy coding should be applied</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <span class="comment">// case 1: empty source message</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">if</span> (srcBegin == srcEnd) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    mMetadata[slot] = <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a>{0, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d30/classuint64__t.html">uint64_t</a>), <span class="keyword">sizeof</span>(stream_t), probabilityBits, <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782ae5c1b61d3810e29aebbc8fba3978d362">Metadata::OptStore::NODATA</a>, 0, 0, 0, 0};</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  static_assert(std::is_same&lt;W, stream_t&gt;());</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  std::unique_ptr&lt;rans::SymbolStatistics&gt; stats = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a> md;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">auto</span>* bl = &amp;mBlocks[slot];</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keyword">auto</span>* meta = &amp;mMetadata[slot];</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">// resize underlying buffer of block if necessary and update all pointers.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keyword">auto</span> expandStorage = [&amp;](<span class="keywordtype">int</span> dictElems, <span class="keywordtype">int</span> encodeBufferElems) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keyword">auto</span> szNeed = estimateBlockSize(dictElems, encodeBufferElems); <span class="comment">// size in bytes!!!</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (szNeed &gt;= getFreeSize()) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <a class="code" href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Slot &quot;</span> &lt;&lt; slot &lt;&lt; <span class="stringliteral">&quot;: free size: &quot;</span> &lt;&lt; getFreeSize() &lt;&lt; <span class="stringliteral">&quot;, need &quot;</span> &lt;&lt; szNeed;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">if</span> (buffer) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        expand(*buffer, <a class="code" href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a>() + (szNeed - getFreeSize()));</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        meta = &amp;(<span class="keyword">get</span>(buffer-&gt;data())-&gt;mMetadata[slot]);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        bl = &amp;(<span class="keyword">get</span>(buffer-&gt;data())-&gt;mBlocks[slot]); <span class="comment">// in case of resizing this and any this.xxx becomes invalid</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;no room for encoded block in provided container&quot;</span>);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  };</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">// case 3: message where entropy coding should be applied</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (opt == <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782a1d44bfe69b33f3ab9efcfbb651a80f9d">Metadata::OptStore::EENCODE</a>) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="comment">// build symbol statistics</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    stats = std::make_unique&lt;rans::SymbolStatistics&gt;(srcBegin, srcEnd);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    stats-&gt;rescaleToNBits(probabilityBits);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keyword">const</span> <a class="code" href="../../dd/d50/classo2_1_1rans_1_1Encoder.html">o2::rans::Encoder64&lt;S&gt;</a> encoder{*stats, probabilityBits};</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dictSize = stats-&gt;getFrequencyTable().size();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">// estimate size of encode buffer</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a4e6d4067fb0d4a480d4e22a3bc1cec9e">dataSize</a> = <a class="code" href="../../d5/d86/namespaceo2_1_1rans.html#a3b984fb60bc1a7e867b0a337dde4aec8">rans::calculateMaxBufferSize</a>(stats-&gt;getMessageLength(),</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                                stats-&gt;getAlphabetRangeBits(),</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                                <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6a/structS.html">S</a>));</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// preliminary expansion of storage based on dict size + estimated size of encode buffer</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    expandStorage(dictSize, dataSize);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">//store dictionary first</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    bl-&gt;storeDict(dictSize, stats-&gt;getFrequencyTable().data());</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// directly encode source message into block buffer.</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> encodedMessageEnd = encoder.process(bl-&gt;getData(), bl-&gt;getData() + <a class="code" href="../../dc/da3/glcorearb_8h.html#a4e6d4067fb0d4a480d4e22a3bc1cec9e">dataSize</a>, srcBegin, srcEnd);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    dataSize = encodedMessageEnd - bl-&gt;getData();</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">// update the size claimed by encode message directly inside the block</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    bl-&gt;nStored = bl-&gt;nDict + <a class="code" href="../../dc/da3/glcorearb_8h.html#a4e6d4067fb0d4a480d4e22a3bc1cec9e">dataSize</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    *meta = <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a>{stats-&gt;getMessageLength(), <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d30/classuint64__t.html">uint64_t</a>), <span class="keyword">sizeof</span>(stream_t), probabilityBits, opt,</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                     stats-&gt;getMinSymbol(), stats-&gt;getMaxSymbol(), dictSize, dataSize};</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">// store original data w/o EEncoding</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> messageLength = (srcEnd - srcBegin);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> szb = messageLength * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6a/structS.html">S</a>);</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="../../dc/da3/glcorearb_8h.html#a4e6d4067fb0d4a480d4e22a3bc1cec9e">dataSize</a> = szb / <span class="keyword">sizeof</span>(stream_t) + (<span class="keyword">sizeof</span>(<a class="code" href="../../d1/d6a/structS.html">S</a>) &lt; <span class="keyword">sizeof</span>(stream_t));</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// no dictionary needed</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    expandStorage(0, dataSize);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    *meta = <a class="code" href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">Metadata</a>{messageLength, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d30/classuint64__t.html">uint64_t</a>), <span class="keyword">sizeof</span>(stream_t), probabilityBits, opt,</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                     0, 0, 0, dataSize};</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    bl-&gt;storeData(meta-&gt;nDataWords, reinterpret_cast&lt;const W*&gt;(srcBegin));</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">// resize block if necessary</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  bl-&gt;endBlock();</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;} <span class="comment">// namespace ctf</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;} <span class="comment">// namespace o2</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="structo2_1_1ctf_1_1Metadata_html_ae29676747ce01621c5895b26ff688782ae5c1b61d3810e29aebbc8fba3978d362"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782ae5c1b61d3810e29aebbc8fba3978d362">o2::ctf::Metadata::OptStore::NODATA</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Registry_html_aa46ab12310e47c160a79ce3c3dafafa0"><div class="ttname"><a href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#aa46ab12310e47c160a79ce3c3dafafa0">o2::ctf::Registry::getFreeBlockStart</a></div><div class="ttdeci">char * getFreeBlockStart() const</div><div class="ttdoc">calculate the pointer of the head of the writable space </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00100">EncodedBlocks.h:100</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a0a221b005894579fea3b9eb7bfc2ee71"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a0a221b005894579fea3b9eb7bfc2ee71">image</a></div><div class="ttdeci">GLeglImageOES image</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04021">glcorearb.h:4021</a></div></div>
<div class="ttc" id="testPayloadEncoder_8cxx_html_aa22649bfc3bd2b1734b0804bb90b050f"><div class="ttname"><a href="../../d2/ded/testPayloadEncoder_8cxx.html#aa22649bfc3bd2b1734b0804bb90b050f">estimateSize</a></div><div class="ttdeci">int estimateSize()</div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_aa160104733244d7309adca999ace2e7a"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#aa160104733244d7309adca999ace2e7a">o2::ctf::Alignment</a></div><div class="ttdeci">constexpr size_t Alignment</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00031">EncodedBlocks.h:31</a></div></div>
<div class="ttc" id="namespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">information complementary to a CCDB object (path, metadata, startTimeValidity, endTimeValidity etc) ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00022">BitstreamReader.h:22</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_a0796d4945640fb8e3a9d4972b4e585d9"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#a0796d4945640fb8e3a9d4972b4e585d9">o2::ctf::appendToTree</a></div><div class="ttdeci">void appendToTree(TTree &amp;tree, const std::string brname, T &amp;ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd7/CTFWriterSpec_8cxx_source.html#l00037">CTFWriterSpec.cxx:37</a></div></div>
<div class="ttc" id="GPUReconstructionIncludes_8h_html_a287eedb5aeb3e2204ded2924050fb641"><div class="ttname"><a href="../../d7/d94/GPUReconstructionIncludes_8h.html#a287eedb5aeb3e2204ded2924050fb641">assert</a></div><div class="ttdeci">#define assert(param)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d94/GPUReconstructionIncludes_8h_source.html#l00021">GPUReconstructionIncludes.h:21</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a86c97211ed5538faf9876fde304c870d"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a86c97211ed5538faf9876fde304c870d">o2::ctf::Block::getDict</a></div><div class="ttdeci">W * getDict()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00132">EncodedBlocks.h:132</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_aff774113b4668a8c33d20c113733dc95"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#aff774113b4668a8c33d20c113733dc95">o2::ctf::Block::relocate</a></div><div class="ttdeci">void relocate(const char *oldHead, char *newHeadData, char *newHeadRegistry)</div><div class="ttdoc">relocate to different head position </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00226">EncodedBlocks.h:226</a></div></div>
<div class="ttc" id="GPUCommonLogger_8h_html_aea3d0edfe28fc0325c636b2b33f0527a"><div class="ttname"><a href="../../df/d5b/GPUCommonLogger_8h.html#aea3d0edfe28fc0325c636b2b33f0527a">LOG</a></div><div class="ttdeci">#define LOG(type)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5b/GPUCommonLogger_8h_source.html#l00028">GPUCommonLogger.h:28</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a4568fc090febc136eed4577a600739ca"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a4568fc090febc136eed4577a600739ca">v</a></div><div class="ttdeci">const GLdouble * v</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00832">glcorearb.h:832</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_abc51b0c0a175495bad9ba3b5f02d4e93"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abc51b0c0a175495bad9ba3b5f02d4e93">o2::ctf::EncodedBlocks::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdoc">total allocated size in bytes </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00287">EncodedBlocks.h:287</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_aa70f7215ca0aaae2fa67fb85b7f7ffcb"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#aa70f7215ca0aaae2fa67fb85b7f7ffcb">o2::ctf::alignSize</a></div><div class="ttdeci">size_t alignSize(size_t sizeBytes)</div><div class="ttdoc">align size to given diven number of bytes </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00040">EncodedBlocks.h:40</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a24e423762e06e2bc78076d96ce5417a2"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a24e423762e06e2bc78076d96ce5417a2">o2::ctf::EncodedBlocks::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">clear itself </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00542">EncodedBlocks.h:542</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a347345f71646cd95c2a7459bbf4c9842"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a347345f71646cd95c2a7459bbf4c9842">o2::ctf::EncodedBlocks::setHeader</a></div><div class="ttdeci">void setHeader(const H &amp;h)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00243">EncodedBlocks.h:243</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a3aaff1e64e6278b7f9075eeab44d1bc6"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3aaff1e64e6278b7f9075eeab44d1bc6">o2::ctf::EncodedBlocks::getMetadata</a></div><div class="ttdeci">const auto &amp; getMetadata() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00247">EncodedBlocks.h:247</a></div></div>
<div class="ttc" id="qconfigoptions_8h_html_ad6a3458d4354900cec9f1644c84948d1"><div class="ttname"><a href="../../d8/de9/qconfigoptions_8h.html#ad6a3458d4354900cec9f1644c84948d1">compression</a></div><div class="ttdeci">Visualize clusters only Timeframe settings Average distance in cm of events merged into Randomize distance around average distance of merged events Simulate correct bunch interactions instead of placing only the average number of events A value [n] sets TFlen for [n] collisions in Number of bunches per train Number of bunch trains Instantaneous interaction rate Do not simulate border Total number of collisions to be placed in the interior of all time Do not select random but walk over array of events in stride steps h QA settings const char Legend entries for data from comparison histogram files const char Store histograms in output root Do not run but just create PDFs from input root files Set cut for Q Compute the efficiency including impure tracks with fake contamination Maxmimum Create resolution histograms in the native fit Filter for Filter for Particle Store mc labels to file for later matching Minimum Pt of a matched track to be displayed Compare QA QAonly Event generator settings h Reconstruction settings Enable TRD processing compression</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/qconfigoptions_8h_source.html#l00072">qconfigoptions.h:72</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ac1922a4178604c0a73bde4b200ed9ee6"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac1922a4178604c0a73bde4b200ed9ee6">o2::ctf::EncodedBlocks::estimateBlockSize</a></div><div class="ttdeci">static size_t estimateBlockSize(int _ndict, int _ndata)</div><div class="ttdoc">estimate free size needed to add new block </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00272">EncodedBlocks.h:272</a></div></div>
<div class="ttc" id="structS_html"><div class="ttname"><a href="../../d1/d6a/structS.html">S</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df1/cxx14-test-aggregate-initialization_8cxx_source.html#l00017">cxx14-test-aggregate-initialization.cxx:17</a></div></div>
<div class="ttc" id="namespaceo2_1_1mid_html_aca82e9e929edf59c003b2a1b07a3ec69"><div class="ttname"><a href="../../df/d18/namespaceo2_1_1mid.html#aca82e9e929edf59c003b2a1b07a3ec69">o2::mid::clear</a></div><div class="ttdeci">simClustering correlation clear()</div></div>
<div class="ttc" id="structo2_1_1ctf_1_1ANSHeader_html_abaf306f6a83070c115b0c5a335a3e0f7"><div class="ttname"><a href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#abaf306f6a83070c115b0c5a335a3e0f7">o2::ctf::ANSHeader::majorVersion</a></div><div class="ttdeci">uint8_t majorVersion</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00056">EncodedBlocks.h:56</a></div></div>
<div class="ttc" id="testBareElinkEncoder_8cxx_html_a61d454dcf3f57efb6c741c369b92cbf8"><div class="ttname"><a href="../../d7/d33/testBareElinkEncoder_8cxx.html#a61d454dcf3f57efb6c741c369b92cbf8">print</a></div><div class="ttdeci">void print(const char *msg, const ElinkEncoder&lt; FORMAT, CHARGESUM &gt; &amp;enc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d33/testBareElinkEncoder_8cxx_source.html#l00119">testBareElinkEncoder.cxx:119</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a5c4947d4516dd7cfa3505ce3a648a4ef"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a5c4947d4516dd7cfa3505ce3a648a4ef">name</a></div><div class="ttdeci">GLuint const GLchar * name</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00781">glcorearb.h:781</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ad6964e2f1336bd82e4506752d7308cff"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad6964e2f1336bd82e4506752d7308cff">o2::ctf::EncodedBlocks::encode</a></div><div class="ttdeci">void encode(const VE &amp;src, int slot, uint8_t probabilityBits, Metadata::OptStore opt, VB *buffer=nullptr)</div><div class="ttdoc">encode vector src to bloc at provided slot </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00315">EncodedBlocks.h:315</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a6406121e1440325e1fc4b0e3f1506ce4"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6406121e1440325e1fc4b0e3f1506ce4">o2::ctf::EncodedBlocks::copyToFlat</a></div><div class="ttdeci">void copyToFlat(void *base)</div><div class="ttdoc">copy itself to flat buffer created on the fly at the provided pointer. The destination block should b...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00301">EncodedBlocks.h:301</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a6bf756e6e1c4bc2a8a5e4caa5e0ff8f4"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6bf756e6e1c4bc2a8a5e4caa5e0ff8f4">o2::ctf::EncodedBlocks::mBlocks</a></div><div class="ttdeci">std::array&lt; Block&lt; W &gt;, N &gt; mBlocks</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00342">EncodedBlocks.h:342</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_acf9ae78e9ec49ffcd1c29fc7410d1c48"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#acf9ae78e9ec49ffcd1c29fc7410d1c48">o2::ctf::Block::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">clear itself </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00146">EncodedBlocks.h:146</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ab443ecb6cb5d9775a65f445f855dd068"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab443ecb6cb5d9775a65f445f855dd068">o2::ctf::EncodedBlocks::compactify</a></div><div class="ttdeci">size_t compactify()</div><div class="ttdoc">Compactify by eliminating empty space. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00284">EncodedBlocks.h:284</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_a47c34e2a9290f7a6251f3a4e0021d1e2"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#a47c34e2a9290f7a6251f3a4e0021d1e2">o2::ctf::WrappersCompressionLevel</a></div><div class="ttdeci">constexpr int WrappersCompressionLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00034">EncodedBlocks.h:34</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a3667f558219c90437106b544a3ca00b8"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a></div><div class="ttdeci">GLuint buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00655">glcorearb.h:655</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a8c60995bd0c2c8c06be04f790624b2e5"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8c60995bd0c2c8c06be04f790624b2e5">o2::ctf::Block::storeData</a></div><div class="ttdeci">void storeData(int _ndata, const W *_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00177">EncodedBlocks.h:177</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_aefd9063250065412dc2c6eb723715afe"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aefd9063250065412dc2c6eb723715afe">o2::ctf::EncodedBlocks::copyToFlat</a></div><div class="ttdeci">void copyToFlat(V &amp;vec)</div><div class="ttdoc">copy itself to flat buffer created on the fly from the vector </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00456">EncodedBlocks.h:456</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ae54384c11e9cff5e296476d9f33ae4d1"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae54384c11e9cff5e296476d9f33ae4d1">o2::ctf::EncodedBlocks::getHeader</a></div><div class="ttdeci">H &amp; getHeader()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00245">EncodedBlocks.h:245</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a55c17f669f5a8964c48353ed196467b6"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a55c17f669f5a8964c48353ed196467b6">o2::ctf::Block::storeDict</a></div><div class="ttdeci">void storeDict(int _ndict, const W *_dict)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00159">EncodedBlocks.h:159</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a3d1e3edfcf61ca2d831883e1afbad89e"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a3d1e3edfcf61ca2d831883e1afbad89e">size</a></div><div class="ttdeci">GLsizeiptr size</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00659">glcorearb.h:659</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a9f5c32c4ccb8a00a51d1fcb0f2006f01"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9f5c32c4ccb8a00a51d1fcb0f2006f01">o2::ctf::EncodedBlocks::getNBlocks</a></div><div class="ttdeci">static constexpr int getNBlocks()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00253">EncodedBlocks.h:253</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a8ad949649e1e599f76c8ab3814aae219"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a8ad949649e1e599f76c8ab3814aae219">o2::ctf::Block::getNDict</a></div><div class="ttdeci">int getNDict() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00136">EncodedBlocks.h:136</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a9974673b455dd802a139bfa1b5c39413"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9974673b455dd802a139bfa1b5c39413">o2::ctf::EncodedBlocks::mRegistry</a></div><div class="ttdeci">Registry mRegistry</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00336">EncodedBlocks.h:336</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_adf063580118adfecfb984b0ad901bb83"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#adf063580118adfecfb984b0ad901bb83">o2::ctf::EncodedBlocks::create</a></div><div class="ttdeci">static auto create(void *head, size_t sz)</div><div class="ttdoc">create container from arbitrary buffer of predefined size (in bytes!!!). Head is supposed to respect ...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00568">EncodedBlocks.h:568</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a61fd53321d30d2fd70d35b60fbe5090a"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61fd53321d30d2fd70d35b60fbe5090a">o2::ctf::EncodedBlocks::getANSHeader</a></div><div class="ttdeci">const ANSHeader &amp; getANSHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00250">EncodedBlocks.h:250</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Registry_html"><div class="ttname"><a href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html">o2::ctf::Registry</a></div><div class="ttdoc">registry struct for the buffer start and offsets of writable space </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00093">EncodedBlocks.h:93</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a39d60c21a76ab4c89cd21c16f0ab964d"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a39d60c21a76ab4c89cd21c16f0ab964d">o2::ctf::EncodedBlocks::appendToTree</a></div><div class="ttdeci">void appendToTree(TTree &amp;tree, const std::string &amp;name) const</div><div class="ttdoc">attach to tree </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00404">EncodedBlocks.h:404</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a30e823ac8c858ec9122baf5c327e02eb"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30e823ac8c858ec9122baf5c327e02eb">o2::ctf::EncodedBlocks::estimateSizeFromMetadata</a></div><div class="ttdeci">size_t estimateSizeFromMetadata() const</div><div class="ttdoc">do the same using metadata info </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00481">EncodedBlocks.h:481</a></div></div>
<div class="ttc" id="classo2_1_1rans_1_1SymbolStatistics_html"><div class="ttname"><a href="../../d2/d85/classo2_1_1rans_1_1SymbolStatistics.html">o2::rans::SymbolStatistics</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/SymbolStatistics_8h_source.html#l00036">SymbolStatistics.h:36</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ac8f9f9ff9048ed510535b9343c8a19af"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ac8f9f9ff9048ed510535b9343c8a19af">o2::ctf::EncodedBlocks::setANSHeader</a></div><div class="ttdeci">void setANSHeader(const ANSHeader &amp;h)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00249">EncodedBlocks.h:249</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a5436cc865355f1b777b4c24395ffd397"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a5436cc865355f1b777b4c24395ffd397">o2::ctf::Block::~Block</a></div><div class="ttdeci">~Block()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00138">EncodedBlocks.h:138</a></div></div>
<div class="ttc" id="namespaceo2_1_1rans_html"><div class="ttname"><a href="../../d5/d86/namespaceo2_1_1rans.html">o2::rans</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7a/Coder_8h_source.html#l00030">Coder.h:30</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_afb54a7f40abc09c5f84340c7636788d1"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#afb54a7f40abc09c5f84340c7636788d1">o2::ctf::EncodedBlocks::mMetadata</a></div><div class="ttdeci">std::array&lt; Metadata, N &gt; mMetadata</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00341">EncodedBlocks.h:341</a></div></div>
<div class="ttc" id="namespaceo2_1_1emcal_html_a6c868ddf88a9b19f60067aebad08b9d4a2f9917fd4cd650c84d0599f223287dbc"><div class="ttname"><a href="../../db/dc1/namespaceo2_1_1emcal.html#a6c868ddf88a9b19f60067aebad08b9d4a2f9917fd4cd650c84d0599f223287dbc">o2::emcal::NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dda/DataFormats_2Detectors_2EMCAL_2include_2DataFormatsEMCAL_2Constants_8h_source.html#l00106">Constants.h:106</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a13784e3c1672987dc92d6e8fb1bd89a2"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a13784e3c1672987dc92d6e8fb1bd89a2">o2::ctf::EncodedBlocks::readFromTree</a></div><div class="ttdeci">void readFromTree(TTree &amp;tree, const std::string &amp;name, int ev=0)</div><div class="ttdoc">read from tree to non-flat object </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00377">EncodedBlocks.h:377</a></div></div>
<div class="ttc" id="classo2_1_1rans_1_1Encoder_html"><div class="ttname"><a href="../../dd/d50/classo2_1_1rans_1_1Encoder.html">o2::rans::Encoder</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d74/Utilities_2rANS_2include_2rANS_2Encoder_8h_source.html#l00035">Encoder.h:35</a></div></div>
<div class="ttc" id="test__Algorithm_8cxx_html_a5216308b2bcc588018b96379974d290c"><div class="ttname"><a href="../../d2/d0e/test__Algorithm_8cxx.html#a5216308b2bcc588018b96379974d290c">max</a></div><div class="ttdeci">const size_t max</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/test__Algorithm_8cxx_source.html#l00040">test_Algorithm.cxx:40</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ad1d812ed0ac3b35139656fe9e070f35e"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad1d812ed0ac3b35139656fe9e070f35e">o2::ctf::EncodedBlocks::getFreeSize</a></div><div class="ttdeci">size_t getFreeSize() const</div><div class="ttdoc">size remaining for additional data </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00290">EncodedBlocks.h:290</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ae9bb90cc3237ae8f3755a54c42d9c6d2"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae9bb90cc3237ae8f3755a54c42d9c6d2">o2::ctf::EncodedBlocks::init</a></div><div class="ttdeci">void init(size_t sz)</div><div class="ttdoc">this is in fact stored, but to overcome TBuffer limits we have to define the branches per block!!! ...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00527">EncodedBlocks.h:527</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1ANSHeader_html"><div class="ttname"><a href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html">o2::ctf::ANSHeader</a></div><div class="ttdoc">&gt;&gt;======================== Auxiliary classes =======================&gt;&gt; </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00055">EncodedBlocks.h:55</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Registry_html_a35eb073a9d1ae2c7d645e3142983ab18"><div class="ttname"><a href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a35eb073a9d1ae2c7d645e3142983ab18">o2::ctf::Registry::getFreeSize</a></div><div class="ttdeci">size_t getFreeSize() const</div><div class="ttdoc">size in bytes available to fill data </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00114">EncodedBlocks.h:114</a></div></div>
<div class="ttc" id="namespaceo2_1_1rans_html_a3b984fb60bc1a7e867b0a337dde4aec8"><div class="ttname"><a href="../../d5/d86/namespaceo2_1_1rans.html#a3b984fb60bc1a7e867b0a337dde4aec8">o2::rans::calculateMaxBufferSize</a></div><div class="ttdeci">size_t calculateMaxBufferSize(size_t num, size_t rangeBits, size_t sizeofStreamT)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da1/helper_8h_source.html#l00039">helper.h:39</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a2d430bc0f51e55a6cddc4ca49026e7af"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a2d430bc0f51e55a6cddc4ca49026e7af">o2::ctf::Block::getData</a></div><div class="ttdeci">const W * getData() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00133">EncodedBlocks.h:133</a></div></div>
<div class="ttc" id="classuint64__t_html"><div class="ttname"><a href="../../d6/d30/classuint64__t.html">uint64_t</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_aa6c6e7651749d02ac2ec47f432e7fbf1"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#aa6c6e7651749d02ac2ec47f432e7fbf1">o2::ctf::EncodedBlocks::empty</a></div><div class="ttdeci">bool empty() const</div><div class="ttdoc">check if empty and valid </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00275">EncodedBlocks.h:275</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a6eba317e3cf44d6d26c04a5a8f197dcb"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a></div><div class="ttdeci">GLboolean GLboolean GLboolean b</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a3275ee8121097f6edd1699258dd424c7"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a3275ee8121097f6edd1699258dd424c7">o2::ctf::EncodedBlocks::relocate</a></div><div class="ttdeci">static void relocate(const char *oldHead, char *newHead, char *wrapper, size_t newsize=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00510">EncodedBlocks.h:510</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ad856da2afe92c5d1a228e21221c1602b"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ad856da2afe92c5d1a228e21221c1602b">o2::ctf::EncodedBlocks::getHeader</a></div><div class="ttdeci">const H &amp; getHeader() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00244">EncodedBlocks.h:244</a></div></div>
<div class="ttc" id="namespaceo2_1_1utils_html_a332816247e55f35ed5119b3dbd665d26"><div class="ttname"><a href="../../d0/d28/namespaceo2_1_1utils.html#a332816247e55f35ed5119b3dbd665d26">o2::utils::concat_string</a></div><div class="ttdeci">std::string concat_string(Ts const &amp;... ts)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8f/StringUtils_8h_source.html#l00085">StringUtils.h:85</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Registry_html_a9d78d817489bcdee225107478aac6021"><div class="ttname"><a href="../../d0/d1c/structo2_1_1ctf_1_1Registry.html#a9d78d817489bcdee225107478aac6021">o2::ctf::Registry::shrinkFreeBlock</a></div><div class="ttdeci">void shrinkFreeBlock(size_t sz)</div><div class="ttdoc">advance the head of the writeable space </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00107">EncodedBlocks.h:107</a></div></div>
<div class="ttc" id="namespaceo2_1_1mch_1_1raw_html_aeec8f9de7175e5ccef417cd8968d1ac7"><div class="ttname"><a href="../../d2/d26/namespaceo2_1_1mch_1_1raw.html#aeec8f9de7175e5ccef417cd8968d1ac7">o2::mch::raw::encode</a></div><div class="ttdeci">uint32_t encode(const DsDetId &amp;id)</div><div class="ttdoc">Create an integer code for the given id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d4f/DsDetId_8cxx_source.html#l00027">DsDetId.cxx:27</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Metadata_html_ae29676747ce01621c5895b26ff688782"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782">o2::ctf::Metadata::OptStore</a></div><div class="ttdeci">OptStore</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00064">EncodedBlocks.h:64</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a90ac68a9e2a0cd23862c2ed1d0fb3afd"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a90ac68a9e2a0cd23862c2ed1d0fb3afd">o2::ctf::Block::estimateSize</a></div><div class="ttdeci">static size_t estimateSize(int _ndict, int _ndata)</div><div class="ttdoc">estimate free size needed to add new block </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00153">EncodedBlocks.h:153</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Metadata_html_a3d1fe656972103c748084405eb451166"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#a3d1fe656972103c748084405eb451166">o2::ctf::Metadata::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00080">EncodedBlocks.h:80</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ade44fd63c8b3b0bce7875a5d45b6c102"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ade44fd63c8b3b0bce7875a5d45b6c102">o2::ctf::EncodedBlocks::expand</a></div><div class="ttdeci">static auto expand(VB &amp;buffer, size_t newsizeBytes)</div><div class="ttdoc">expand the storage to new size in bytes </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00494">EncodedBlocks.h:494</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Metadata_html_ae29676747ce01621c5895b26ff688782a1d44bfe69b33f3ab9efcfbb651a80f9d"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782a1d44bfe69b33f3ab9efcfbb651a80f9d">o2::ctf::Metadata::OptStore::EENCODE</a></div></div>
<div class="ttc" id="glcorearb_8h_html_afa0fb1b5e976920c0abeff2dca3ed774"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a></div><div class="ttdeci">GLfloat GLfloat GLfloat GLfloat h</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01976">glcorearb.h:1976</a></div></div>
<div class="ttc" id="Logger_8h_html"><div class="ttname"><a href="../../dd/da4/Logger_8h.html">Logger.h</a></div></div>
<div class="ttc" id="test__Algorithm_8cxx_html_af7be6f6143db3904668b719460e15009"><div class="ttname"><a href="../../d2/d0e/test__Algorithm_8cxx.html#af7be6f6143db3904668b719460e15009">min</a></div><div class="ttdeci">const size_t min</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0e/test__Algorithm_8cxx_source.html#l00039">test_Algorithm.cxx:39</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_a2c7c357a9e7b41805002daf1fd9d79d8"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#a2c7c357a9e7b41805002daf1fd9d79d8">o2::ctf::readFromTree</a></div><div class="ttdeci">bool readFromTree(TTree &amp;tree, const std::string brname, T &amp;dest, int ev=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d12/CTFReaderSpec_8cxx_source.html#l00038">CTFReaderSpec.cxx:38</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1ANSHeader_html_ae00e41a2ff0bab7de041248506bb8fd1"><div class="ttname"><a href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#ae00e41a2ff0bab7de041248506bb8fd1">o2::ctf::ANSHeader::minorVersion</a></div><div class="ttdeci">uint8_t minorVersion</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00057">EncodedBlocks.h:57</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a85e9b5bc7aa7dd65bcca25df8f748895"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a85e9b5bc7aa7dd65bcca25df8f748895">o2::ctf::EncodedBlocks::getMinAlignedSize</a></div><div class="ttdeci">static size_t getMinAlignedSize()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00255">EncodedBlocks.h:255</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_ac4f81e21c9916c0ef309fe8f9b4a8189"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ac4f81e21c9916c0ef309fe8f9b4a8189">o2::ctf::Block::getNData</a></div><div class="ttdeci">int getNData() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00135">EncodedBlocks.h:135</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a35637d4923ea13a25ec5390d1c291813"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a35637d4923ea13a25ec5390d1c291813">o2::ctf::EncodedBlocks::fillTreeBranch</a></div><div class="ttdeci">static void fillTreeBranch(TTree &amp;tree, const std::string &amp;brname, D &amp;dt, int compLevel, int splitLevel=99)</div><div class="ttdoc">add and fill single branch </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00431">EncodedBlocks.h:431</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a61ce778e88ae55800d49d9b46260cbac"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a61ce778e88ae55800d49d9b46260cbac">o2::ctf::EncodedBlocks::fillFlatCopy</a></div><div class="ttdeci">void fillFlatCopy(EncodedBlocks &amp;dest) const</div><div class="ttdoc">Create its own flat copy in the destination empty flat object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00441">EncodedBlocks.h:441</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1ANSHeader_html_a5b9ca95c0746a7c645e9a3c72617410f"><div class="ttname"><a href="../../dc/dbb/structo2_1_1ctf_1_1ANSHeader.html#a5b9ca95c0746a7c645e9a3c72617410f">o2::ctf::ANSHeader::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00059">EncodedBlocks.h:59</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a69556a5d7d83658a093e1d2ad2445b08"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a69556a5d7d83658a093e1d2ad2445b08">o2::ctf::EncodedBlocks::getANSHeader</a></div><div class="ttdeci">ANSHeader &amp; getANSHeader()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00251">EncodedBlocks.h:251</a></div></div>
<div class="ttc" id="classo2_1_1rans_1_1Encoder_html_a8b1c72037483eca59fb7c9d34934a1cf"><div class="ttname"><a href="../../dd/d50/classo2_1_1rans_1_1Encoder.html#a8b1c72037483eca59fb7c9d34934a1cf">o2::rans::Encoder::stream_t</a></div><div class="ttdeci">stream_T stream_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d74/Utilities_2rANS_2include_2rANS_2Encoder_8h_source.html#l00057">Encoder.h:57</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html">o2::ctf::EncodedBlocks</a></div><div class="ttdoc">&lt;&lt;======================== Auxiliary classes =======================&lt;&lt; </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00238">EncodedBlocks.h:238</a></div></div>
<div class="ttc" id="classo2_1_1rans_1_1Decoder_html"><div class="ttname"><a href="../../d0/d91/classo2_1_1rans_1_1Decoder.html">o2::rans::Decoder</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d62/Utilities_2rANS_2include_2rANS_2Decoder_8h_source.html#l00035">Decoder.h:35</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_aa1c9dd9453617d8d847092824ee7a4c1"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#aa1c9dd9453617d8d847092824ee7a4c1">o2::ctf::WrappersSplitLevel</a></div><div class="ttdeci">constexpr int WrappersSplitLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00033">EncodedBlocks.h:33</a></div></div>
<div class="ttc" id="StringUtils_8h_html"><div class="ttname"><a href="../../d4/d8f/StringUtils_8h.html">StringUtils.h</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_af28de74fa2a5626839d8975a66caeacb"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#af28de74fa2a5626839d8975a66caeacb">o2::ctf::EncodedBlocks::mHeader</a></div><div class="ttdeci">H mHeader</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00340">EncodedBlocks.h:340</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a323e891e294642746723d9981402ed60"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a323e891e294642746723d9981402ed60">o2::ctf::EncodedBlocks::readTreeBranch</a></div><div class="ttdeci">static void readTreeBranch(TTree &amp;tree, const std::string &amp;brname, D &amp;dt, int ev=0)</div><div class="ttdoc">read single branch </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00417">EncodedBlocks.h:417</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ab1c2e567ff37876e0897b911a57a7b1d"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ab1c2e567ff37876e0897b911a57a7b1d">o2::ctf::EncodedBlocks::getImage</a></div><div class="ttdeci">static const auto getImage(const void *newHead)</div><div class="ttdoc">get const image of the container wrapper, with pointers in the image relocated to new head ...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00554">EncodedBlocks.h:554</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a6eac3a6976e46e605ab878679a99cd68"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a6eac3a6976e46e605ab878679a99cd68">o2::ctf::EncodedBlocks::mANSHeader</a></div><div class="ttdeci">ANSHeader mANSHeader</div><div class="ttdoc">not stored </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00339">EncodedBlocks.h:339</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Metadata_html_ae29676747ce01621c5895b26ff688782a96fd97346a337137c5796ebf7bfcca8a"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html#ae29676747ce01621c5895b26ff688782a96fd97346a337137c5796ebf7bfcca8a">o2::ctf::Metadata::OptStore::ROOTCompression</a></div></div>
<div class="ttc" id="glcorearb_8h_html_a4e6d4067fb0d4a480d4e22a3bc1cec9e"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a4e6d4067fb0d4a480d4e22a3bc1cec9e">dataSize</a></div><div class="ttdeci">GLenum GLsizei dataSize</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l03994">glcorearb.h:3994</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a3f875b5e24a47499a3583a86508b1418"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a3f875b5e24a47499a3583a86508b1418">o2::ctf::Block::store</a></div><div class="ttdeci">void store(int _ndict, int _ndata, const W *_dict, const W *_data)</div><div class="ttdoc">store binary blob data (buffer filled from head to tail) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00203">EncodedBlocks.h:203</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_a4b638fccf2b5ccc5ad3f578fd624241b"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#a4b638fccf2b5ccc5ad3f578fd624241b">o2::ctf::BufferType</a></div><div class="ttdeci">uint8_t BufferType</div><div class="ttdoc">This is the type of the vector to be used for the EncodedBlocks buffer allocation. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00037">EncodedBlocks.h:37</a></div></div>
<div class="ttc" id="GPUCommonAlgorithm_8h_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00385">GPUCommonAlgorithm.h:385</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a9e8a6a8e8f330d975f5e151d92f665f3"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9e8a6a8e8f330d975f5e151d92f665f3">o2::ctf::EncodedBlocks::decode</a></div><div class="ttdeci">void decode(VD &amp;dest, int slot) const</div><div class="ttdoc">decode block at provided slot to destination vector (will be resized as needed) </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00603">EncodedBlocks.h:603</a></div></div>
<div class="ttc" id="namespaceo2_1_1ctf_html_ac0e06b95c4b1602bbe81ed6cdbeef868"><div class="ttname"><a href="../../d5/d05/namespaceo2_1_1ctf.html#ac0e06b95c4b1602bbe81ed6cdbeef868">o2::ctf::relocatePointer</a></div><div class="ttdeci">T * relocatePointer(const char *oldBase, char *newBase, const T *ptr)</div><div class="ttdoc">relocate pointer by the difference of addresses </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00048">EncodedBlocks.h:48</a></div></div>
<div class="ttc" id="namespaceo2_1_1framework_1_1raw__parser_html_a7bf575809244793f9212ebdc02beaa39"><div class="ttname"><a href="../../d3/df4/namespaceo2_1_1framework_1_1raw__parser.html#a7bf575809244793f9212ebdc02beaa39">o2::framework::raw_parser::create</a></div><div class="ttdeci">ConcreteParserVariants&lt; PageSize &gt; create(T const *buffer, size_t size)</div><div class="ttdoc">create a raw parser depending on version of RAWDataHeader found at beginning of data ...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d22/RawParser_8h_source.html#l00266">RawParser.h:266</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a536199d8f0723028e5b7c7b337586dbe"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a536199d8f0723028e5b7c7b337586dbe">o2::ctf::Block::endBlock</a></div><div class="ttdeci">void endBlock()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00196">EncodedBlocks.h:196</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_ae8d78563f06dfeb49a3590c0dc8ed7f9"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#ae8d78563f06dfeb49a3590c0dc8ed7f9">o2::ctf::EncodedBlocks::print</a></div><div class="ttdeci">void print() const</div><div class="ttdoc">print itself </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00592">EncodedBlocks.h:592</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_a89a86a7af8f9751ed26d73d62b1c821e"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#a89a86a7af8f9751ed26d73d62b1c821e">o2::ctf::Block::getDict</a></div><div class="ttdeci">const W * getDict() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00134">EncodedBlocks.h:134</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Metadata_html"><div class="ttname"><a href="../../d9/d6d/structo2_1_1ctf_1_1Metadata.html">o2::ctf::Metadata</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00063">EncodedBlocks.h:63</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_abed9840c0447cc39c2d4b018b031a230"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#abed9840c0447cc39c2d4b018b031a230">o2::ctf::EncodedBlocks::base</a></div><div class="ttdeci">EncodedBlocks&lt; H, N, W &gt; base</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00241">EncodedBlocks.h:241</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html_ae96653babe0614d00002125d71336f08"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html#ae96653babe0614d00002125d71336f08">o2::ctf::Block::getData</a></div><div class="ttdeci">W * getData()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00131">EncodedBlocks.h:131</a></div></div>
<div class="ttc" id="structo2_1_1ctf_1_1Block_html"><div class="ttname"><a href="../../d5/db7/structo2_1_1ctf_1_1Block.html">o2::ctf::Block</a></div><div class="ttdoc">binary blob for single entropy-compressed column: metadata + (optional) dictionary and data buffer + ...</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00124">EncodedBlocks.h:124</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a9690d6865fb7515b20a6849aa77f0a10"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a9690d6865fb7515b20a6849aa77f0a10">o2::ctf::EncodedBlocks::flat</a></div><div class="ttdeci">bool flat() const</div><div class="ttdoc">check if flat and valid </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00278">EncodedBlocks.h:278</a></div></div>
<div class="ttc" id="classo2_1_1ctf_1_1EncodedBlocks_html_a30672fcec0a70a571ecb9c836752abe7"><div class="ttname"><a href="../../dc/d08/classo2_1_1ctf_1_1EncodedBlocks.html#a30672fcec0a70a571ecb9c836752abe7">o2::ctf::EncodedBlocks::estimateSize</a></div><div class="ttdeci">size_t estimateSize() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d91/EncodedBlocks_8h_source.html#l00467">EncodedBlocks.h:467</a></div></div>
<div class="ttc" id="rans_8h_html"><div class="ttname"><a href="../../d4/de7/rans_8h.html">rans.h</a></div><div class="ttdoc">header for public api </div></div>
<div class="ttc" id="glcorearb_8h_html_a2a98ddb6f79ec1048ff9e15cdd2422ba"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a2a98ddb6f79ec1048ff9e15cdd2422ba">src</a></div><div class="ttdeci">GLenum src</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01767">glcorearb.h:1767</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_2171f7ec022c5423887b07c69b2f5b48.html">DataFormats</a></li><li class="navelem"><a class="el" href="../../dir_2801adc79bf3c286b1b479858d2cade4.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_74593c7a91e03746ae2a516888bf9494.html">Common</a></li><li class="navelem"><a class="el" href="../../dir_67c58cc5aaf29270141b8a8cdbb7295e.html">include</a></li><li class="navelem"><a class="el" href="../../dir_31cee524eb436ea096641b9630c45e12.html">DetectorsCommonDataFormats</a></li><li class="navelem"><a class="el" href="../../da/d91/EncodedBlocks_8h.html">EncodedBlocks.h</a></li>
    <li class="footer">Generated on Mon Jun 29 2020 22:03:58 for Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
